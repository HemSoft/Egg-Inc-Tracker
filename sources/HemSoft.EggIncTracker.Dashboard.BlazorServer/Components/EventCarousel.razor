@using MudBlazor

<div class="event-carousel @(_isDarkMode ? "dark-mode" : "light-mode")"
    style="z-index: 1; height: 100%; display: flex; align-items: center; justify-content: center; width: 100%;">
    @if (_isLoading)
    {
        <MudProgressCircular Size="Size.Small" Indeterminate="true" />
    }
    else if (!string.IsNullOrEmpty(_errorMessage))
    {
        <MudText Typo="Typo.subtitle1" Color="Color.Error">@_errorMessage</MudText>
    }
    else if (_carouselItems.Count == 0)
    {
        <MudText Typo="Typo.subtitle1">No items to display</MudText>
    }
    else if (_currentItem != null)
    {
        <div class="d-flex align-center justify-center" style="width: 100%; position: relative;">
            <!-- Previous button -->
            <MudIconButton Icon="@Icons.Material.Filled.ChevronLeft" Color="Color.Default" Size="Size.Small"
                OnClick="PreviousItemAsync" Class="carousel-nav-button carousel-prev-button"
                Style="position: absolute; left: 0; z-index: 2;" Disabled="@_isTransitioning" />

            <!-- Carousel content -->
            <div class="d-flex flex-column align-center justify-center event-content @_transitionClass"
                style="width: 100%; padding: 0 40px;">
                <div class="d-flex align-center">
                    <MudIcon Icon="@_currentItem.Icon" Color="@_currentItem.IconColor" Size="Size.Medium" Class="mr-2" />
                    <MudText Typo="Typo.subtitle1" Color="@_currentItem.IconColor">@_currentItem.SubTitle</MudText>
                </div>
                <MudText Typo="Typo.caption" Class="mt-1">@_currentItem.TimeText</MudText>

                <!-- Carousel indicators -->
                <div class="d-flex justify-center mt-1">
                    @for (int i = 0; i < _carouselItems.Count; i++)
                    {
                        var index = i;
                        <div class="carousel-indicator @(index == _currentIndex ? "active" : "")"
                            @onclick="async () => await GoToItemAsync(index)"></div>
                    }
                </div>
            </div>

            <!-- Next button -->
            <MudIconButton Icon="@Icons.Material.Filled.ChevronRight" Color="Color.Default" Size="Size.Small"
                OnClick="NextItemAsync" Class="carousel-nav-button carousel-next-button"
                Style="position: absolute; right: 0; z-index: 2;" Disabled="@_isTransitioning" />
        </div>
    }
</div>

<style>
    .event-carousel.dark-mode {
        color: rgba(255, 255, 255, 0.9);
    }

    .event-carousel.light-mode {
        color: rgba(0, 0, 0, 0.9);
    }

    .event-content {
        transition: opacity 0.3s ease-in-out;
        opacity: 1;
    }

    .event-content.fade-out {
        opacity: 0;
        transition: opacity 0.3s ease-out;
    }

    .event-content.fade-in {
        opacity: 1;
        transition: opacity 0.3s ease-in;
    }

    .carousel-indicator {
        width: 8px;
        height: 8px;
        border-radius: 50%;
        background-color: rgba(128, 128, 128, 0.5);
        margin: 0 3px;
        cursor: pointer;
        transition: background-color 0.3s ease;
    }

    .carousel-indicator.active {
        background-color: var(--mud-palette-primary);
    }

    .carousel-nav-button {
        opacity: 0.6;
        transition: opacity 0.3s ease;
    }

    .carousel-nav-button:hover {
        opacity: 1;
    }

    .event-carousel.dark-mode .carousel-nav-button {
        color: rgba(255, 255, 255, 0.7);
    }

    .event-carousel.light-mode .carousel-nav-button {
        color: rgba(0, 0, 0, 0.7);
    }
</style>
